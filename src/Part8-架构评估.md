# 架构评估

其中的质量属性概念在上一 Part 中介绍过了，这里着重介绍评估方法。

基本可以分为 3 类，基于问卷调查、基于场景和基于度量的方法。

- 基于调查问卷，关键是设计好问卷或检查表，充分利用系统相关人员的经验和知识，获得对架构的评估。缺点是很大成都上依赖于评估人员的主观推断。
- 基于场景的评估方法，在架构权衡分析法（ATAM）和软件架构分析方法（SAAM）中应用。通过分析软件架构对场景的支持程度，从而判断该架构对这一场景所代表的质量需求的满足程度。
  > 也就是上一章讲的质量属性与质量属性场景
- 基于度量的评估方法，建立在软件架构度量的基础上，设计 3 个基本活动，首先需要建立质量属性和度量之间的映射原则，然后从软件架构文档中获取度量信息，最后根据映射原则推导出系统的质量属性。

# SAAM 方法

是一种非功能质量属性的架构分析方法

- 特定目标，SAAM 的目标是对描述应用程序属性的文档，验证基本的架构假设和原则，该分析方法有利于评估架构固有的风险。SAAM 指导对架构的检查，使其主要关注潜在的问题点，如需求冲突，或仅从某一参与者观点出发得出的不全面的系统设计。
- 评估技术，SAAM 所使用的是场景技术。场景代表了描述架构属性的基础，描述了各种系统必须支持的活动和可能存在的状态变化。
- 质量属性，这一方法的基本特点是把任何形式的质量属性都具体化为场景，但**可修改性**是 SAAM 分析的主要质量属性。
- 风险承担着。SAAM 协调不同参与者之间感兴趣的共同方面，作为后续决策的基础。
- 架构描述，SAAM 用于架构的最后版本，但早于详细设计。架构的描述形式应当被所有参与者理解。功能、结构和分配被定义为描述架构的三个主要方面。
- 方法活动。SAAM 的主要输入是问题描述、需求声明和架构描述<br/>SAAM 分析评估架构的过程包括 5 个步骤，即场景开发、架构描述、单个场景评估、场景交互和总体评估。<br/>通过各类风险承担者协商讨论，开发一些任务场景，体现系统所支持的各种活动。<br/> 用一种易于理解的、合乎语法规则的架构描述软件架构，体现系统的计算构件、数据构件、以及构件之间的关系（数据与控制）。对场景（直接场景和间接场景）生成一个关于特定架构的场景描述列表。通过对场景交互的分析，能够得出系统中所有场景对系统中的构件所产生影响的列表。最后，对场景与场景之间的交互作一个总体的权衡和评价。
- SAAM 不考虑已有知识库的可重用性
- 方法验证，SAAM 是一个成熟的方法。

## 总结

SAAM 主要关注的是**可修改性**，同样使用质量属性和质量属性场景对架构进行评估，根据场景开发和体系结构描述获得单个场景评估，再获得场景交互评估，最后是总体评估。

# ATAM 方法

是在 SAAM 基础上发展起来的，主要针对性能、实用性、安全性和可修改性，在系统开发之前，对这些质量属性进行评价和折中。

ATAM 方法采用效用树这一工具来对质量属性进行分类和优先级排序

效用树的结构包括树根——质量属性——属性分类——质量属性场景，主要关注性能、安全性、可修改性、可用性，这 4 个是利益相关者最为关心的。

得到初始的效用树后，需要修剪这棵树，保留重要场景，再对场景按重要性给定优先级，再按场景实现的难易度来确定优先级。

- 特定目标，ATAM 的目标是在考虑多个互相影响的质量属性的情况下，从原则上提供一种理解软件架构的能力的方法，对于特定的软件架构，在系统开发之前，可以使用 ATAM 方法确定在多个质量属性之间折中的必要性。
- 质量属性，ATAM 方法分析多个互相竞争的质量属性。
- 风险承担者，在场景、需求收集相关活动中，ATAM 方法需要所有系统相关人员的参与。
- 架构描述，架构空间受到历史遗留系统、互操作性和以前失败的项目约束。基于 5 种基本结构来进行，这 5 中结构是从 4+1 视图派生来的，其中逻辑视图被分为功能结构和代码结构。这些结构加上他们之间适当的映射可以完整的描述一个架构。<br/>用一组消息顺序图表示运行时的交互场景，对架构描述加以注解。
- 评估技术，可以把 ATAM 方法视为一个框架，该框架依赖于质量属性，可以使用不同的分析技术。它集成了多种优秀的单一理论模型，其中每种都能高效、实用的处理属性。从不同的架构角度，有 3 种不同类型的场景，分别是用例（包括对系统典型的使用、引出信息）、增长场景（用于涵盖那些对它的系统的修改）、探测场景（用于涵盖那些可能会对系统造成过载的极端修改）<br/>ATAM 还使用定性的启发式分析方法，在对一个质量属性构造了一个精确分析模型时要进行分析，定性的启发式分析方法就是这种分析的粗粒度版本。
- 方法的活动，ATAM 被分成 4 个主要的活动领域或阶段，分别是

  - 场景和需求收集
    - 收集场景
    - 收集需求/约束/环境
  - 架构视图和场景实现
    - 描述体系结构视图
    - 实现场景
  - 属性模型构造与分析
    - 特定属性的分析（优秀的单一理论）
  - 折中。
    - 标志折中
    - 标志敏感度

- 领域知识库的可重用性。架构设计变得更加惯例化和更可预测，并得到一个基于属性的架构分析的标准问题集合。
- 方法验证，广泛应用但是又存在一些问题。

## 总结

和 SAAM 一样，ATAM 也使用这几个描述，和 SAAM 的区别在于

- 考虑更多互相影响的属性
- 考虑重用性
- 需要注意他们不同的活动内容
- 更多使用场景，比如用例、增长场景、探测场景
- 使用效用树这一工具

# CBAM 成本效益分析方法

在 ATAM 上构建，用来对架构设计决策的成本和收益进行建模，是优化此类决策的一种手段。

CBAM 的思想就是架构策略影响系统的质量属性，反过来这些质量属性又会为系统的项目干系人带来一些收益(称为“效用”)

CBAM 协助项目干系人根据其投资回报 (Return On Investment,ROI) 选择架构策略。 CBAM 在 ATAM 结束时开始，它实际上使用了 ATAM 评估的结果。

- 整理场景。整理 ATAM 中获取的场景，根据商业目标确定这些场景的优先级，并选取优先级最高的 1/3 的场景进行分析。
- 对场景进行求精。为每个场景获取最坏情况、当前情况、期望情况和最好情况的质量属性响应级别。
- 确定场景的优先级。项目关系人对场景进行投票，其投票是基于每个场景“所期望的”响应值，根据投票结果和票的权值，生成一个分值(场景的权值)。
- 分配效用。对场景的响应级别(最坏情况、当前情况、期望情况和最好情况)确定效用表。
- 架构策略涉及哪些质量属性及响应级别，形成相关的“策略一场景一响应级别”的对应关系。
- 使用内插法确定“期望的”质量属性响应级别的效用。即根据第 4 步的效用表以及第 5 步的对应关系，确定架构策略及其对应场景的效用表。
- 计算各架构策略的总收益。根据第 3 步的场景的权值及第 6 步的架构策略效用表，计算出架构策略的总收益得分。
- 根据受成本限制影响的 ROI 选择架构策略。根据开发经验估算架构策略的成本，结合第 7 步的收益，计算出架构策略的 ROI,按 ROI 排序，从而确定选取策略的优先级。

## 总结

成本效益分析是在 ATAM 基础上进行的，在 ATAM 结束时开始，使用 ATAM 的成果。

在效用树中根据场景排序，重新根据商业目标来确定场景优先级

每个场景都有最坏情况、当前情况、期望情况和最好情况的响应级别

会确定一个效用表以及策略——场景——响应级别的对应关系

# 总结

教材中还提到了很多其他的评估方法，但是就不用太关注了。

后面 8.3 还有一个 ATAM 方法的评估实践，可以看一看深入理解。评测的是胡佛架构和银行架构，完全没有提到过的两种特定领域的架构。所以教材很多地方很难串起来。

评估方法是用来评估架构的，这里的架构比如解释器架构、虚拟机架构等等，分析这些架构在性能、实用性、安全性和可修改性这些质量属性上的优缺点，找出风险、非风险、敏感点和权衡点。最后确定使用哪个架构方法。
