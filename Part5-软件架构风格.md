# 软件架构风格

体系结构风格定义了一个系统家族，即一个体系结构定义一个词汇表和一组约束。词汇表中包含一些构件与连接件类型，而这组约束指出系统是如何将这些构件和连接件组合起来的。

体系结构风格反应了领域中众多系统所共有的结构和语义特性，并指导如何将各个模块和子系统有效的组织成一个完整的系统。

软件设计方法

# 数据流体系结构风格

还记得信息系统里面的业务处理系统吗，通过批处理和联机事务处理实现数据处理。

数据流体系风格主要就包含批处理和管道-过滤器两种风格。数据流风格的数据是流动的、一步一步处理的，处理顺序并不固定，基于指令输入参数，比如编译器，通过对代码逐层进行处理最后得到可执行的机器码。

## 批处理

批处理中每一个处理步骤是一个单独的程序，每一步必须在前一步结束后才能开始，并且数据必须是完整的，以整体的方式传递。构件是独立的应用程序，连接件是某种类型的媒介。通常输入与输出都只有一个并且没有路径判断，数据的类型也比较单一。

## 管道-过滤器

批处理显得太死板了，管道过滤器将系统分解为几个序贯的处理步骤，步骤之间通过数据流连接，一个步骤的输出是另一个步骤的输入。每一个步骤由一个过滤器实现，处理步骤之间的数据传输由管道负责，每个处理步骤都有一组输入和输出，并不是唯一的输入与输出。相对批处理，更适合数据类型多样，处理方法不同的数据。

# 调用/返回体系结构风格

调用/返回很好理解，和函数化思想比较相似，将不同的功能包装成一个函数，通过调用/返回的模式解耦合。

## 主程序/子程序风格

一般采用单线程控制，将问题划分成若干处理步骤，在主程序中调用子程序获取结果。构件就是主程序和子程序，连接件就是过程调用。

## 面向对象体系结构风格

以对象的数据结构划分构件，构件之间的连接件就是对象中的操作或者方法。

## 层次型体系结构风格

层次结构教程上的图不知道为什么是个圆，其实就按层来画就好看多了，将构件分层规划，层与层之间只有相邻的层可见，接口也只对相邻的层开放，每一层最多只影响相邻的两层，比如网络 7 层模型等。

## 客户端/服务器体系结构风格

C/S 风格大家就很熟悉了，多个终端对应一个服务器，称为胖客户机，瘦服务器。

后来演变成了三层 C/S 结构，划分成客户机、应用服务器、数据库三层，对应表示层、功能层和数据层，只有表示层存于客户机上，整个应用逻辑放在应用服务器上。也是目前使用范围最广的风格。

B/S 也是三层 C/S 结构，C/S 本身就是二层，所以不要问二层去哪了。

# 以数据为中心的体系风格

这个风格下的两种都比较简单，顾名思义是以数据为中心，数据是唯一的，多个其他子系统对数据进行操作。

## 仓库体系结构风格

在仓库中，只有两种不同的构件

- 中央数据结构：说明当前数据的状态
- 一组对数据进行操作的独立构件

比如仓库中，围绕货物有入库、搬运、出库等操作。

## 黑板体系结构风格

适用于解决复杂的非结构化问题，在求解过程中综合运用多种不同的知识源，使得问题的表达、组织和求解变得比较容易。

和仓库的区别在于，有两种数据，一个是黑板上的共享数据，一个是外部的多种数据源。

通过将问题拆解成不同应用相关的分级结构，分级结构的每一层信息由一个唯一的词汇来描述，代表了问题的部分解。

对于特定应用问题，黑板系统可以通过选取各种黑板、知识源和控制模块的构件来设计，也可以利用预先定制的黑板体系结构的变成环境。传统应用是信号处理领域和松耦合代理数据共享存取。

# 虚拟机体系结构风格

比如 Java 虚拟机，基本思想就是人为构建一个运行环境，在这个环境中，可以解析和运行**自定义**的一些语言，增加架构的灵活性。

重点在于自定义的和灵活性，看到这样的描述基本就确定是虚拟机了。

## 解释器体系结构风格

一个解释器通常包括完成解释工作的解释引擎，一个包含将被解释的代码的存储区，一个记录解释引擎当前状态的数据结构，一个记录源代码被解释执行进度的数据结构。

解释器通常被用来简历一种虚拟机以弥合程序语义与硬件语义中间的差异，缺点是执行效率较低，比如专家系统。

## 规则系统体系结构风格

包含规则集、规则解释器、规则/数据选择器、工作内存。

算是解释器风格的一个扩展，增加规则集（知识库）、规则/数据选择器和工作内存。可能这个工作内存比较难理解，解释器的功能比较单一，和批处理类似，规则系统则是根据不同的输入，在规则/数据集中选取特定的规则和数据，再经过规则解释器输出，工作内存则是输入，并且响应变化的数据存储模块，比如一个订单系统，规则 1、规则 2 可以选取数据的订单的状态，这个数据的操作过程就是在工作内存中执行的。

# 独立构件体系结构风格

强调每一个构件都是独立的个体，之间**不直接通信**，以降低耦合度、提升灵活性。

## 进程通信体系结构风格

进程之间的通信通过消息传递，可以是点到点、异步或同步以及远程过程调用等。

## 事件系统体系结构风格

基于事件的隐式调用风格，构件不直接调用一个过程，而是触发或广播一个或多个事件。系统的其他构件中的过程在一个或多个事件中注册，当一个事件被触发，系统自动调用在这个事件中的注册的所有过程。

特点是事件的触发者并不知道那些构件会被事件影响，也不能明确事件的触发顺序，哪些构件中的事件被触发。

# 总结

一个系统中并不是单一使用某一个风格，经常是根据不同的情况和要求去选取的。比如这个子系统可以用虚拟机，另一个子系统是数据流，总之了解不同的风格，针对不同的情况去选择
